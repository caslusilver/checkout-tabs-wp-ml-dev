================================================================================
                   CHECKOUT TABS WP ML - VERS√ÉO 1.0
                   POP-UP DE INICIALIZA√á√ÉO (LOGIN/SIGNUP)
================================================================================

Data de Cria√ß√£o: 12/01/2026
Status: Pendente
Prioridade: Alta
Escopo: Sistema de autentica√ß√£o, geolocaliza√ß√£o e sess√£o do usu√°rio

================================================================================
                           √çNDICE DE MELHORIAS
================================================================================

[1.1] Replicar campo reCAPTCHA na aba "Criar uma conta"
[1.2] Anima√ß√£o CSS de carregamento ("‚Ä¢‚Ä¢‚Ä¢") ao aceitar localiza√ß√£o
[1.3] Refor√ßar debug de geolocaliza√ß√£o para Desktop
[1.4] Manter usu√°rio logado ap√≥s login/signup (persist√™ncia de sess√£o)
[1.5] Ocultar vari√°veis/c√≥digos HTML quebrados enquanto localiza√ß√£o n√£o √© aceita

================================================================================
                        DETALHAMENTO DAS MELHORIAS
================================================================================

--------------------------------------------------------------------------------
[1.1] REPLICAR CAMPO RECAPTCHA NA ABA "CRIAR UMA CONTA"
--------------------------------------------------------------------------------

PROBLEMA IDENTIFICADO:
O reCAPTCHA s√≥ √© exibido na aba de Login. Quando o usu√°rio est√° na aba 
"Criar uma conta" e tenta submeter o formul√°rio sem completar o reCAPTCHA,
recebe erro mas precisa voltar √† aba anterior para visualiz√°-lo.

SOLU√á√ÉO IMPLEMENTADA:
Quando o usu√°rio tenta submeter o formul√°rio de signup sem completar o reCAPTCHA,
uma mensagem de erro √© exibida com um link clic√°vel "Clique aqui para completar 
o reCAPTCHA". Ao clicar no link, o sistema:
1. Volta automaticamente para a aba de Login
2. Destaca o reCAPTCHA com um stroke vermelho circulando a caixa
3. Faz scroll suave at√© o reCAPTCHA
4. Remove o destaque ap√≥s 5 segundos

ARQUIVOS MODIFICADOS:

1. assets/js/login-signup.js
   Localiza√ß√£o: Linhas 123-145 (valida√ß√£o do reCAPTCHA no signup)
   
   IMPLEMENTA√á√ÉO:
   ```javascript
   if (!recaptchaResponse) {
     // Mensagem de erro com link clic√°vel
     var linkHtml = '<a href="#" id="ctwpml-goto-recaptcha" style="color:#3483fa;font-weight:bold;">Clique aqui para completar o reCAPTCHA</a>';
     setMsg($msg, 'Por favor, complete o reCAPTCHA. ' + linkHtml, true);
     
     // Handler para voltar √† aba de login e destacar reCAPTCHA
     $(document).off('click', '#ctwpml-goto-recaptcha').on('click', '#ctwpml-goto-recaptcha', function(e) {
       e.preventDefault();
       // Trocar para aba login
       $('#login-popup .ctwpml-auth-tab[data-tab="login"]').trigger('click');
       
       // Aguardar a aba de login aparecer e o reCAPTCHA estar vis√≠vel
       setTimeout(function() {
         var recContainer = $('#ctwpml-recaptcha-login-container');
         var recWidget = $('#g-recaptcha-login');
         
         // Adicionar classe de erro no container e destacar com stroke vermelho
         if (recContainer.length) {
           recContainer.addClass('ctwpml-recaptcha-error');
           recContainer.css({
             'border': '2px solid #dc2626',
             'border-radius': '4px',
             'padding': '4px',
             'background-color': 'rgba(220, 38, 38, 0.05)'
           });
         }
         
         // Tamb√©m destacar o widget do reCAPTCHA se existir
         if (recWidget.length) {
           recWidget.css({
             'outline': '2px solid #dc2626',
             'outline-offset': '2px'
           });
         }
         
         // Scroll suave para o reCAPTCHA
         if (recContainer.length && recContainer[0].scrollIntoView) {
           recContainer[0].scrollIntoView({ behavior: 'smooth', block: 'center' });
         }
         
         // Remover destaque ap√≥s 5 segundos
         setTimeout(function() {
           recContainer.removeClass('ctwpml-recaptcha-error');
           recContainer.css({
             'border': '',
             'border-radius': '',
             'padding': '',
             'background-color': ''
           });
           recWidget.css({
             'outline': '',
             'outline-offset': ''
           });
         }, 5000);
       }, 300); // Aguardar 300ms para garantir que a aba foi trocada
     });
     return;
   }
   ```

2. assets/css/login-popup.css
   Localiza√ß√£o: Linhas 195-217 (estilos de erro do reCAPTCHA)
   
   IMPLEMENTA√á√ÉO:
   ```css
   /* Estado de erro do reCAPTCHA - stroke vermelho circulando a caixa */
   #ctwpml-recaptcha-login-container.ctwpml-recaptcha-error {
     border: 2px solid #dc2626 !important;
     border-radius: 4px !important;
     padding: 4px !important;
     background-color: rgba(220, 38, 38, 0.05) !important;
     animation: ctwpml-shake 0.5s ease-in-out;
     box-shadow: 0 0 0 2px rgba(220, 38, 38, 0.2) !important;
   }
   
   #g-recaptcha-login {
     transition: outline 0.3s ease;
   }
   
   #g-recaptcha-login[style*="outline"] {
     outline: 2px solid #dc2626 !important;
     outline-offset: 2px !important;
   }
   
   @keyframes ctwpml-shake {
     0%, 100% { transform: translateX(0); }
     25% { transform: translateX(-5px); }
     75% { transform: translateX(5px); }
   }
   ```

3. inc/frontend/login-popup.php
   Localiza√ß√£o: Linhas 57-65 (container do reCAPTCHA no login)
   
   VERIFICA√á√ÉO:
   - Container #ctwpml-recaptcha-login-container existe (linha 62)
   - Widget #g-recaptcha-login existe (linha 63)
   - IDs est√£o corretos e correspondem aos seletores no JavaScript

FLUXO DE FUNCIONAMENTO:
1. Usu√°rio est√° na aba "Criar uma conta"
2. Preenche nome e e-mail
3. Tenta submeter o formul√°rio SEM completar o reCAPTCHA
4. Sistema exibe mensagem de erro: "Por favor, complete o reCAPTCHA. Clique aqui para completar o reCAPTCHA"
5. Usu√°rio clica no link "Clique aqui para completar o reCAPTCHA"
6. Sistema automaticamente:
   - Troca para a aba "Login"
   - Adiciona stroke vermelho (borda + outline) circulando o reCAPTCHA
   - Faz scroll suave at√© o reCAPTCHA
   - Remove o destaque ap√≥s 5 segundos
7. Usu√°rio completa o reCAPTCHA na aba Login
8. Usu√°rio volta para aba Signup e submete novamente (agora funcionar√°)

TESTES REQUERIDOS:
- [x] Abrir popup de login no checkout
- [x] Ir para aba "Criar uma conta"
- [x] Tentar submeter sem completar reCAPTCHA
- [x] Verificar se mensagem de erro aparece com link clic√°vel
- [x] Clicar no link e verificar se volta para aba login
- [x] Verificar se stroke vermelho aparece circulando o reCAPTCHA
- [x] Verificar se scroll suave funciona
- [x] Verificar se destaque √© removido ap√≥s 5 segundos
- [ ] Completar reCAPTCHA na aba login e voltar para signup
- [ ] Submeter formul√°rio de signup com sucesso

NOTAS IMPORTANTES:
- O timeout de 300ms garante que a aba foi trocada antes de aplicar o destaque
- O destaque √© aplicado tanto no container quanto no widget do reCAPTCHA
- A anima√ß√£o de "shake" chama aten√ß√£o para o erro
- O destaque √© removido automaticamente ap√≥s 5 segundos para n√£o poluir a UI

--------------------------------------------------------------------------------
[1.2] ANIMA√á√ÉO CSS DE CARREGAMENTO ("‚Ä¢‚Ä¢‚Ä¢") AO ACEITAR LOCALIZA√á√ÉO
--------------------------------------------------------------------------------

PROBLEMA IDENTIFICADO:
Quando o usu√°rio aceita compartilhar localiza√ß√£o, a mensagem "Ativando 
localiza√ß√£o..." √© exibida de forma est√°tica, sem feedback visual de que
algo est√° acontecendo.

ARQUIVOS A MODIFICAR:

1. assets/js/geolocation-permission-modal.js
   Localiza√ß√£o: Linha 91 (fun√ß√£o setStatus)
   
   A√á√ÉO: Modificar para incluir anima√ß√£o de pontos

2. assets/css/geolocation-permission-modal.css
   
   A√á√ÉO: Adicionar anima√ß√£o CSS para os pontos

   C√ìDIGO A ADICIONAR:
   ```css
   .ctwpml-geo-loading-dots::after {
     content: '';
     animation: ctwpml-dots 1.5s infinite;
   }
   
   @keyframes ctwpml-dots {
     0% { content: ''; }
     25% { content: '‚Ä¢'; }
     50% { content: '‚Ä¢‚Ä¢'; }
     75% { content: '‚Ä¢‚Ä¢‚Ä¢'; }
     100% { content: ''; }
   }
   
   /* Fallback para navegadores que n√£o suportam anima√ß√£o de content */
   .ctwpml-geo-loading-text {
     display: inline-flex;
     align-items: center;
   }
   
   .ctwpml-geo-loading-text .ctwpml-dots {
     display: inline-block;
     width: 20px;
     text-align: left;
   }
   
   .ctwpml-geo-loading-text .ctwpml-dots::after {
     content: '';
     animation: ctwpml-dots-alt 1.2s infinite step-end;
   }
   
   @keyframes ctwpml-dots-alt {
     0% { content: '‚Ä¢'; }
     33% { content: '‚Ä¢‚Ä¢'; }
     66% { content: '‚Ä¢‚Ä¢‚Ä¢'; }
   }
   ```

3. assets/js/geolocation-permission-modal.js
   Localiza√ß√£o: Linha 91-92
   
   MODIFICAR setStatus() PARA:
   ```javascript
   function setStatus(msg, isLoading) {
     var el = document.getElementById('ctwpml-geo-status');
     if (!el) return;
     
     if (isLoading) {
       el.innerHTML = '<span class="ctwpml-geo-loading-text">' + 
         (msg || 'Carregando') + 
         '<span class="ctwpml-dots"></span></span>';
     } else {
       el.textContent = msg || '';
     }
   }
   ```
   
   MODIFICAR chamada na linha 92 (dentro do click handler):
   ```javascript
   setStatus('Ativando localiza√ß√£o', true);  // true = isLoading
   ```

TESTES REQUERIDOS:
- [ ] Acessar p√°gina de produto (n√£o logado)
- [ ] Verificar se popup de geolocaliza√ß√£o aparece
- [ ] Clicar em "Permitir"
- [ ] Verificar se anima√ß√£o "‚Ä¢‚Ä¢‚Ä¢" aparece ap√≥s "Ativando localiza√ß√£o"
- [ ] Verificar se anima√ß√£o para quando localiza√ß√£o √© obtida

--------------------------------------------------------------------------------
[1.3] REFOR√áAR DEBUG DE GEOLOCALIZA√á√ÉO PARA DESKTOP
--------------------------------------------------------------------------------

PROBLEMA IDENTIFICADO:
O popup de permiss√£o de localiza√ß√£o n√£o est√° aparecendo em desktop,
dificultando diagn√≥stico do problema.

ARQUIVOS A MODIFICAR:

1. assets/js/geolocation-permission-modal.js
   
   A√á√ÉO: Adicionar logs de debug mais detalhados

   C√ìDIGO A ADICIONAR (no in√≠cio do arquivo, ap√≥s 'use strict'):
   ```javascript
   var DEBUG_GEO = true; // For√ßar debug temporariamente
   
   function geoLog(msg, data) {
     if (!DEBUG_GEO) return;
     try {
       var prefix = '[CTWPML GEO DEBUG] ';
       if (data) {
         console.log(prefix + msg, data);
       } else {
         console.log(prefix + msg);
       }
     } catch(e) {}
   }
   ```

   ADICIONAR LOGS em pontos estrat√©gicos:
   
   Linha ~127 (fun√ß√£o init):
   ```javascript
   function init() {
     geoLog('init() chamado');
     geoLog('navigator.geolocation dispon√≠vel:', 'geolocation' in navigator);
     geoLog('navigator.permissions dispon√≠vel:', !!(navigator && navigator.permissions));
     geoLog('GEO.ensureSessionCache:', typeof GEO.ensureSessionCache);
     geoLog('GEO.requestAndFetch:', typeof GEO.requestAndFetch);
     
     // ... resto do c√≥digo existente
   }
   ```
   
   Linha ~114 (shouldShowModalViaPermissionsApi):
   ```javascript
   function shouldShowModalViaPermissionsApi() {
     geoLog('Verificando permissions API...');
     
     if (!navigator || !navigator.permissions || !navigator.permissions.query) {
       geoLog('Permissions API n√£o dispon√≠vel, retornando true');
       return Promise.resolve(true);
     }
     
     return navigator.permissions
       .query({ name: 'geolocation' })
       .then(function (res) {
         geoLog('Permissions query result:', res ? res.state : 'null');
         return res && res.state === 'prompt';
       })
       .catch(function (err) {
         geoLog('Permissions query error:', err);
         return true;
       });
   }
   ```

2. inc/geolocation/enqueue.php
   
   A√á√ÉO: Verificar se scripts est√£o sendo carregados corretamente em desktop

   VERIFICAR:
   - Se h√° condi√ß√µes que impedem carregamento em desktop
   - Se o script est√° sendo enfileirado corretamente

3. CRIAR NOVO ARQUIVO: assets/js/geolocation-debug.js (tempor√°rio)
   
   PROP√ìSITO: Script de diagn√≥stico que pode ser removido ap√≥s resolver o problema
   
   ```javascript
   (function() {
     'use strict';
     
     var report = {
       timestamp: new Date().toISOString(),
       userAgent: navigator.userAgent,
       isMobile: /Mobile|Android|iPhone|iPad/i.test(navigator.userAgent),
       isDesktop: !/Mobile|Android|iPhone|iPad/i.test(navigator.userAgent),
       hasGeolocation: 'geolocation' in navigator,
       hasPermissions: !!(navigator && navigator.permissions),
       modalOverlayExists: !!document.getElementById('ctwpml-geo-modal-overlay'),
       CTWPMLGeoExists: typeof window.CTWPMLGeo !== 'undefined',
       CTWPMLGeoParamsExists: typeof window.CTWPMLGeoParams !== 'undefined',
     };
     
     console.table(report);
     
     // Verificar estado da permiss√£o
     if (navigator.permissions && navigator.permissions.query) {
       navigator.permissions.query({ name: 'geolocation' })
         .then(function(result) {
           console.log('[GEO DEBUG] Permission state:', result.state);
         })
         .catch(function(err) {
           console.log('[GEO DEBUG] Permission query error:', err);
         });
     }
     
     // Checar sessionStorage
     try {
       var promptShown = sessionStorage.getItem('ctwpml_geo_prompt_shown');
       var freteCache = sessionStorage.getItem('ctwpml_geo_freteData');
       console.log('[GEO DEBUG] Prompt j√° mostrado:', promptShown);
       console.log('[GEO DEBUG] Frete em cache:', !!freteCache);
     } catch(e) {
       console.log('[GEO DEBUG] SessionStorage error:', e);
     }
   })();
   ```

TESTES REQUERIDOS:
- [ ] Abrir console do navegador em Desktop
- [ ] Limpar sessionStorage: sessionStorage.clear()
- [ ] Recarregar p√°gina de produto
- [ ] Verificar logs no console
- [ ] Analisar report gerado
- [ ] Identificar ponto de falha

--------------------------------------------------------------------------------
[1.4] MANTER USU√ÅRIO LOGADO AP√ìS LOGIN/SIGNUP
--------------------------------------------------------------------------------

PROBLEMA IDENTIFICADO:
Necessidade de garantir que o usu√°rio permane√ßa logado ap√≥s criar conta ou 
fazer login, sem necessidade de novo login.

ARQUIVOS A VERIFICAR/MODIFICAR:

1. inc/ajax-signup.php
   Localiza√ß√£o: Linhas 132-134
   
   SITUA√á√ÉO ATUAL (J√Å IMPLEMENTADO):
   ```php
   // Loga automaticamente
   wp_set_current_user($user_id);
   wp_set_auth_cookie($user_id, true);  // true = remember
   ```
   
   A√á√ÉO: J√° est√° implementado corretamente. Verificar se est√° funcionando.
   
   POSS√çVEL PROBLEMA:
   - O cookie pode n√£o estar sendo persistido corretamente
   - Conflito com cache de p√°gina
   
   ADICIONAR VERIFICA√á√ÉO:
   ```php
   // Ap√≥s linha 134, adicionar:
   if (function_exists('checkout_tabs_wp_ml_is_debug_enabled') && checkout_tabs_wp_ml_is_debug_enabled()) {
     error_log('[CTWPML] Signup: Cookie de autentica√ß√£o definido para user_id=' . $user_id);
     error_log('[CTWPML] Signup: is_user_logged_in()=' . (is_user_logged_in() ? 'true' : 'false'));
   }
   ```

2. inc/ajax-login.php
   Localiza√ß√£o: Linhas 77-83
   
   SITUA√á√ÉO ATUAL:
   ```php
   $creds = [
     'user_login' => $email,
     'user_password' => $password,
     'remember' => true,  // J√° est√° como true
   ];
   ```
   
   A√á√ÉO: J√° est√° configurado para "remember me". Verificar persist√™ncia.

3. assets/js/login-signup.js
   
   A√á√ÉO: Ap√≥s login/signup bem-sucedido, verificar se p√°gina recarrega 
   corretamente mantendo a sess√£o
   
   VERIFICAR linhas 144-146 (signup success) e 224-226 (login success):
   ```javascript
   window.location.reload();
   ```
   
   POSS√çVEL MELHORIA:
   Em vez de reload(), usar redirecionamento for√ßado para garantir nova sess√£o:
   ```javascript
   // Substituir window.location.reload() por:
   window.location.href = window.location.href.split('?')[0] + '?ctwpml_session_refresh=' + Date.now();
   ```

TESTES REQUERIDOS:
- [ ] Criar nova conta via popup
- [ ] Verificar se usu√°rio permanece logado ap√≥s reload
- [ ] Fazer logout
- [ ] Fazer login via popup
- [ ] Verificar se usu√°rio permanece logado
- [ ] Fechar navegador e reabrir (testar persist√™ncia)
- [ ] Verificar se sess√£o persiste

--------------------------------------------------------------------------------
[1.5] OCULTAR VARI√ÅVEIS/C√ìDIGOS HTML QUEBRADOS
--------------------------------------------------------------------------------

PROBLEMA IDENTIFICADO:
Antes do popup de permiss√£o de localiza√ß√£o aparecer, vari√°veis n√£o resolvidas
est√£o sendo exibidas no site (ex: {{frete}}, ${valor}), causando visual amador.

ARQUIVOS A MODIFICAR:

1. assets/css/checkout-ui.css ou address-ml-modal.css
   
   A√á√ÉO: Adicionar regra CSS para ocultar elementos com placeholders

   C√ìDIGO A ADICIONAR:
   ```css
   /* Ocultar elementos com placeholders n√£o resolvidos */
   [data-ctwpml-placeholder]:not([data-ctwpml-resolved]) {
     visibility: hidden !important;
   }
   
   /* Ou usar classe espec√≠fica */
   .ctwpml-pending-value {
     visibility: hidden;
   }
   
   .ctwpml-pending-value.ctwpml-resolved {
     visibility: visible;
   }
   
   /* Fallback: ocultar textos que parecem vari√°veis */
   .ctwpml-shipping-price:empty,
   .ctwpml-payment-total-value:empty {
     visibility: hidden;
   }
   ```

2. assets/js/address-ml-screens.js
   
   A√á√ÉO: Adicionar l√≥gica para marcar elementos como "resolvidos"
   
   C√ìDIGO A ADICIONAR (ap√≥s renderizar valores):
   ```javascript
   // Ap√≥s preencher um valor din√¢mico:
   $element.addClass('ctwpml-resolved').attr('data-ctwpml-resolved', 'true');
   ```

3. assets/js/geolocation-client.js
   Localiza√ß√£o: Fun√ß√£o persistContract (linhas 49-59)
   
   A√á√ÉO: Ap√≥s persistir dados, disparar evento para atualizar UI
   
   C√ìDIGO A ADICIONAR (ap√≥s linha 59):
   ```javascript
   function persistContract(data) {
     // ... c√≥digo existente ...
     
     // Ap√≥s persistir, marcar elementos como resolvidos
     try {
       document.querySelectorAll('.ctwpml-pending-value').forEach(function(el) {
         el.classList.add('ctwpml-resolved');
       });
       // Disparar evento customizado
       document.dispatchEvent(new CustomEvent('ctwpml_values_resolved', { detail: data }));
     } catch(e) {}
   }
   ```

4. inc/frontend/login-popup.php (ou template relevante)
   
   A√á√ÉO: Adicionar classe "ctwpml-pending-value" em elementos que exibem
   valores din√¢micos de frete/localiza√ß√£o

TESTES REQUERIDOS:
- [ ] Acessar p√°gina de produto (n√£o logado, sem cache de localiza√ß√£o)
- [ ] Verificar se N√ÉO aparecem textos como {{frete}} ou ${valor}
- [ ] Aceitar permiss√£o de localiza√ß√£o
- [ ] Verificar se valores aparecem corretamente ap√≥s aceitar
- [ ] Testar em diferentes navegadores

================================================================================
                        SISTEMA DE TELEMETRIA E DEBUG
================================================================================

FUNCIONALIDADE IMPLEMENTADA:
Sistema completo de telemetria para rastrear efici√™ncia de cada funcionalidade
da Vers√£o 1.0, permitindo mapear performance, taxa de sucesso e identificar
gargalos.

ARQUIVOS CRIADOS:
1. assets/js/telemetry.js
   - Sistema core de telemetria
   - Rastreamento de eventos, cliques, sucessos/erros
   - C√°lculo de m√©tricas (dura√ß√£o m√©dia, taxa de sucesso, etc.)
   - Armazenamento em sessionStorage
   - Fun√ß√µes: track(), start(), end(), click(), getReport(), exportReport()

2. assets/js/telemetry-panel.js
   - Painel visual flutuante (bot√£o üìä no canto superior direito)
   - Exibe m√©tricas em tempo real
   - Atualiza√ß√£o autom√°tica a cada 2 segundos quando vis√≠vel
   - Bot√µes: Exportar JSON, Limpar dados
   - Acess√≠vel apenas quando debug est√° ativo

INSTRUMENTA√á√ÉO ADICIONADA:

[1.1] reCAPTCHA na aba signup:
- ‚úÖ Rastreamento de valida√ß√£o (start/end)
- ‚úÖ Evento de erro quando reCAPTCHA n√£o preenchido
- ‚úÖ Clique no link de redirecionamento
- ‚úÖ Aplica√ß√£o e remo√ß√£o do destaque visual

[1.2] Anima√ß√£o de geolocaliza√ß√£o:
- ‚úÖ In√≠cio da solicita√ß√£o de geolocaliza√ß√£o
- ‚úÖ In√≠cio da anima√ß√£o de pontos
- ‚úÖ Sucesso/erro ao obter localiza√ß√£o
- ‚úÖ Dura√ß√£o total do processo

[1.3] Debug de geolocaliza√ß√£o Desktop:
- ‚úÖ Inicializa√ß√£o do modal
- ‚úÖ Verifica√ß√£o de permiss√µes
- ‚úÖ Cache hit/miss
- ‚úÖ Exibi√ß√£o do modal

[1.4] Persist√™ncia de sess√£o:
- ‚úÖ Login bem-sucedido
- ‚úÖ Signup bem-sucedido
- ‚úÖ Dados do usu√°rio (sem informa√ß√µes sens√≠veis)

[1.5] Oculta√ß√£o de placeholders:
- ‚úÖ In√≠cio da persist√™ncia de dados
- ‚úÖ Elementos encontrados e resolvidos
- ‚úÖ Erros ao marcar elementos

COMO USAR:

1. Via Console do Navegador:
   ```javascript
   // Ver relat√≥rio completo
   ctwpmlTelemetry.logReport();
   
   // Exportar dados como JSON
   var json = ctwpmlTelemetry.exportReport();
   console.log(json);
   
   // Obter relat√≥rio programaticamente
   var report = ctwpmlTelemetry.getReport();
   console.table(report.features);
   ```

2. Via Painel Visual:
   - Quando debug est√° ativo, aparece bot√£o üìä no canto superior direito
   - Clique para abrir/fechar painel
   - M√©tricas atualizadas automaticamente
   - Bot√£o "Exportar JSON" para salvar relat√≥rio completo

3. M√©tricas Dispon√≠veis:
   - Total de eventos por funcionalidade
   - Taxa de sucesso (%)
   - Contagem de sucessos/erros/cliques
   - Dura√ß√£o m√©dia (ms)
   - Dura√ß√£o m√≠nima/m√°xima
   - √öltimo evento registrado

EXEMPLO DE RELAT√ìRIO:
```json
{
  "report": {
    "sessionStart": "2026-01-12T10:30:00.000Z",
    "sessionDuration": 120000,
    "totalEvents": 15,
    "features": {
      "1.1-recaptcha-signup": {
        "totalEvents": 3,
        "successCount": 1,
        "errorCount": 1,
        "clickCount": 1,
        "successRate": "33.33%",
        "avgDuration": "245.50ms"
      },
      "1.2-geolocation-animation": {
        "totalEvents": 2,
        "successCount": 1,
        "errorCount": 0,
        "clickCount": 0,
        "successRate": "50.00%",
        "avgDuration": "1234.00ms"
      }
    }
  }
}
```

================================================================================
                        CHECKLIST DE IMPLEMENTA√á√ÉO
================================================================================

[‚úÖ] 1.1 - Replicar reCAPTCHA na aba signup
    [‚úÖ] Verificar renderiza√ß√£o do widget
    [‚úÖ] Adicionar mensagem de erro com link
    [‚úÖ] Adicionar estilos de destaque
    [‚úÖ] Adicionar telemetria de rastreamento
    [ ] Testar fluxo completo

[‚úÖ] 1.2 - Anima√ß√£o de carregamento
    [‚úÖ] Adicionar CSS da anima√ß√£o de pontos
    [‚úÖ] Modificar fun√ß√£o setStatus()
    [‚úÖ] Adicionar telemetria de rastreamento
    [ ] Testar em diferentes navegadores

[‚úÖ] 1.3 - Debug de geolocaliza√ß√£o Desktop
    [‚úÖ] Adicionar logs detalhados
    [‚úÖ] Criar script de diagn√≥stico
    [‚úÖ] Adicionar telemetria de rastreamento
    [ ] Identificar causa raiz
    [ ] Corrigir problema identificado

[‚úÖ] 1.4 - Persist√™ncia de sess√£o
    [‚úÖ] Verificar configura√ß√£o atual
    [‚úÖ] Adicionar logs de debug
    [‚úÖ] Adicionar telemetria de rastreamento
    [ ] Testar persist√™ncia
    [ ] Ajustar se necess√°rio

[‚úÖ] 1.5 - Ocultar vari√°veis quebradas
    [‚úÖ] Adicionar CSS de oculta√ß√£o
    [‚úÖ] Marcar elementos como pending
    [‚úÖ] Adicionar l√≥gica de resolu√ß√£o
    [‚úÖ] Adicionar telemetria de rastreamento
    [ ] Testar visual em diferentes estados

================================================================================
                           NOTAS DE DESENVOLVIMENTO
================================================================================

DEPEND√äNCIAS:
- jQuery (j√° carregado)
- Google reCAPTCHA v2 (j√° configurado)
- Geolocation API do navegador
- sessionStorage (para armazenamento de telemetria)

COMPATIBILIDADE:
- Chrome 80+
- Firefox 75+
- Safari 13+
- Edge 80+

CONSIDERA√á√ïES DE SEGURAN√áA:
- Valida√ß√£o de reCAPTCHA sempre no servidor
- N√£o expor informa√ß√µes sens√≠veis em logs de produ√ß√£o

SISTEMA DE TELEMETRIA:
- Scripts: assets/js/telemetry.js, assets/js/telemetry-panel.js
- Enfileirado em: inc/enqueue.php
- Armazenamento: sessionStorage (limpa ao fechar aba)
- Limite: 500 eventos por sess√£o (FIFO)
- Acesso: window.CCTelemetry ou window.ctwpmlTelemetry
- Painel visual: apenas quando debug est√° ativo

ROLLBACK:
- Em caso de problemas, reverter para vers√£o anterior via Git
- Branch de desenvolvimento: develop
- Tag atual: v3.2.44 ‚Üí v3.2.45 (ap√≥s implementa√ß√£o completa)

================================================================================
                              FIM DO DOCUMENTO
================================================================================
